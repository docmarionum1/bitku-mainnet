(this.webpackJsonpbitku=this.webpackJsonpbitku||[]).push([[0],{188:function(e,t){},190:function(e,t){},209:function(e,t,n){},211:function(e,t,n){},287:function(e,t,n){"use strict";n.r(t);var a=n(5);Object(a.e)().put("accessNode.api","https://access-mainnet-beta.onflow.org").put("challenge.handshake","https://fcl-discovery.onflow.org/authn");var r="",i="",c="",o="0xf61e40c19db2a9e2";Object(a.e)().put("0xFUNGIBLETOKENADDRESS","0xf233dcee88fe0abe").put("0xTOKENADDRESS","0x1654653399040a61").put("0xNONFUNGIBLETOKENADDRESS","0x1d7e57aa55817448").put("0xHAIKUNFTADDRESS",o).put("0xFUSDADDRESS","0x3c5959b568896393"),r=o,i="https://bitku.art/logo512.png",c="https://flowscan.org/transaction/";var s,u,l=n(0),p=n.n(l),b=n(15),d=n.n(b),f=(n(209),n(13)),h=n.n(f),j=n(170),x=n(23),O=n(25),g=(n(211),n(330)),k=n(178),m=n(321),v=n(331),F=n(337),S=n(334),w=n(323),y=n(332),N=n(86),D=n.n(N),T=n(115),E=n(40),C="\nimport HaikuNFT from 0xHAIKUNFTADDRESS\n\npub fun main(): {UInt64: UFix64} {\n\n    return {HaikuNFT.totalSupply: HaikuNFT.currentPrice()}\n}\n";function U(){return H.apply(this,arguments)}function H(){return(H=Object(x.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.m([a.l(C)]).then(a.g);case 2:return t=e.sent,n=Object.keys(t)[0],e.abrupt("return",{id:parseInt(n),price:t[n]});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A='\nimport HaikuNFT from 0xHAIKUNFTADDRESS\nimport NonFungibleToken from 0xNONFUNGIBLETOKENADDRESS\n\npub fun main(haikus: { UInt64: Address }): { UInt64: String } {\n  let response: {UInt64: String} = {}\n  for id in haikus.keys {\n    let address = haikus[id]!\n    let account = getAccount(address)\n    let capability = account.getCapability(HaikuNFT.HaikuCollectionPublicPath)\n    let ref = capability.borrow<&{HaikuNFT.HaikuCollectionPublic, NonFungibleToken.CollectionPublic}>() ?? panic("Could not borrow")\n    response[id] = ref.borrowHaiku(id: id).text\n  }\n\n  return response\n}\n';function R(e){return I.apply(this,arguments)}function I(){return(I=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.m([a.l(A),a.b([a.a(t,E.b({key:E.d,value:E.a}))])]).then(a.g);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){return V.apply(this,arguments)}function V(){return(V=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.m([a.l(s||(s=Object(T.a)(['\n      import FungibleToken from 0xFUNGIBLETOKENADDRESS\n      import FUSD from 0xFUSDADDRESS\n      \n      pub fun main(account: Address): UFix64 {\n      \n          let vaultRef = getAccount(account)\n              .getCapability(/public/fusdBalance)\n              .borrow<&FUSD.Vault{FungibleToken.Balance}>()\n              ?? panic("Could not borrow Balance reference to the Vault")\n      \n          return vaultRef.balance\n      }\n    ']))),a.b([a.a(t.addr,E.a)])]).then(a.g);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return K.apply(this,arguments)}function K(){return(K=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.m([a.l(u||(u=Object(T.a)(['\n      import HaikuNFT from 0xHAIKUNFTADDRESS\n      import NonFungibleToken from 0xNONFUNGIBLETOKENADDRESS\n      \n      pub fun main(address: Address): {UInt64: String} {\n        let account = getAccount(address)\n        let capability = account.getCapability(HaikuNFT.HaikuCollectionPublicPath)\n        let ref = capability.borrow<&{HaikuNFT.HaikuCollectionPublic, NonFungibleToken.CollectionPublic}>() ?? panic("Could not borrow")\n      \n        let haikus: {UInt64: String} = {}\n      \n        for id in ref.getIDs() {\n          let nft = ref.borrowNFT(id: id)\n          haikus[id] = ref.borrowHaiku(id: id).text\n        }\n      \n        return haikus\n      }\n    ']))),a.b([a.a(t.addr,E.a)])]).then(a.g);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var L=n(3),G=p.a.createContext();function M(e){var t=e.children,n=Object(l.useState)(0),a=Object(O.a)(n,2),r=a[0],i=a[1],c=Object(l.useState)({}),o=Object(O.a)(c,2),s=o[0],u=o[1];return Object(L.jsx)(G.Provider,{value:{balance:r,setBalance:i,userHaikus:s,setUserHaikus:u},children:t})}function W(){var e=Object(l.useState)({loggedIn:null}),t=Object(O.a)(e,2),n=t[0],r=t[1],i=Object(l.useContext)(G),c=i.balance,o=i.setBalance,s=i.userHaikus,u=i.setUserHaikus;Object(l.useEffect)((function(){return a.f().subscribe(r)}),[]);var p=Object(l.useCallback)(Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B(n);case 3:t=e.sent,o(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),o(null);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[n]);return Object(l.useEffect)((function(){n.loggedIn?p():o(0)}),[n]),Object(l.useEffect)((function(){function e(){return(e=Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P(n);case 3:t=e.sent,u(t),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}n.loggedIn?function(){e.apply(this,arguments)}():u({})}),[n]),{user:n,balance:c,updateBalance:p,userHaikus:s,setUserHaikus:u}}var _=W,z=n(325),J=n(333),Y=n(338);function q(e,t){var n=c+e;t({text:Object(L.jsxs)("span",{children:[" Transaction Submitted. View Status on\xa0",Object(L.jsx)("a",{href:n,target:"_blank",children:"Flowscan"}),"."]}),severity:"success"})}var Q="\nimport FungibleToken from 0xFUNGIBLETOKENADDRESS\nimport FlowToken from 0xTOKENADDRESS\nimport FUSD from 0xFUSDADDRESS\nimport NonFungibleToken from 0xNONFUNGIBLETOKENADDRESS\n\nimport HaikuNFT from 0xHAIKUNFTADDRESS\n\ntransaction (haikuID: UInt64, price: UFix64) {\n    let collection: &NonFungibleToken.Collection\n    let sentVault: @FungibleToken.Vault\n    let receiverRef: &FlowToken.Vault{FungibleToken.Receiver}\n    \n    prepare(signer: AuthAccount) {\n        // if the account doesn't already have a collection\n        if signer.borrow<&HaikuNFT.Collection>(from: HaikuNFT.HaikuCollectionStoragePath) == nil {\n\n\n            // create a new empty collection\n            let collection <- HaikuNFT.createEmptyCollection()\n            \n            // save it to the account\n            signer.save(<-collection, to: HaikuNFT.HaikuCollectionStoragePath)\n\n            // create a public capability for the collection\n            signer.link<&{NonFungibleToken.CollectionPublic, HaikuNFT.HaikuCollectionPublic}>(HaikuNFT.HaikuCollectionPublicPath, target: HaikuNFT.HaikuCollectionStoragePath)\n        }\n\n        self.collection = signer.borrow<&NonFungibleToken.Collection>(from: HaikuNFT.HaikuCollectionStoragePath) \n             ?? panic(\"Could not borrow reference to NFT Collection!\")\n\n        // Get a reference to the signer's stored vault\n        let vaultRef = signer.borrow<&FUSD.Vault>(from: /storage/fusdVault)\n          ?? panic(\"Could not borrow reference to the owner's FUSD Vault!\")\n\n        // Get a reference to the signer's FLOW receiver to receive FLOW necessary to ensure they have\n        // enough storage\n        self.receiverRef =  signer\n          .getCapability(/public/flowTokenReceiver)\n          .borrow<&FlowToken.Vault{FungibleToken.Receiver}>()\n        ?? panic(\"Could not borrow receiver reference to the recipient's Vault\")\n\n        // Withdraw tokens from the signer's stored vault\n        self.sentVault <- vaultRef.withdraw(amount: price)\n    }\n\n    execute {\n        HaikuNFT.mintHaiku(recipient: self.collection, vault: <- self.sentVault, id: haikuID, flowReceiverRef: self.receiverRef)\n    }\n}\n";function X(e,t){return Z.apply(this,arguments)}function Z(){return(Z=Object(x.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.m([a.n(Q),a.b([a.a(t.id,E.d),a.a(t.price,E.c)]),a.j(a.d),a.k(a.d),a.c([a.d]),a.h(9999)]).then(a.g);case 2:return q(r=e.sent,n),e.abrupt("return",a.o(r).onceSealed());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $="\nimport FungibleToken from 0xFUNGIBLETOKENADDRESS\nimport FUSD from 0xFUSDADDRESS\n\ntransaction {\n\n  prepare(signer: AuthAccount) {\n\n    // It's OK if the account already has a Vault, but we don't want to replace it\n    if(signer.borrow<&FUSD.Vault>(from: /storage/fusdVault) != nil) {\n      return\n    }\n    \n    // Create a new FUSD Vault and put it in storage\n    signer.save(<-FUSD.createEmptyVault(), to: /storage/fusdVault)\n\n    // Create a public capability to the Vault that only exposes\n    // the deposit function through the Receiver interface\n    signer.link<&FUSD.Vault{FungibleToken.Receiver}>(\n      /public/fusdReceiver,\n      target: /storage/fusdVault\n    )\n\n    // Create a public capability to the Vault that only exposes\n    // the balance field through the Balance interface\n    signer.link<&FUSD.Vault{FungibleToken.Balance}>(\n      /public/fusdBalance,\n      target: /storage/fusdVault\n    )\n  }\n}\n";function ee(e){return te.apply(this,arguments)}function te(){return(te=Object(x.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.m([a.n($),a.j(a.d),a.k(a.d),a.c([a.d]),a.h(99)]).then(a.g);case 2:return q(n=e.sent,t),e.abrupt("return",a.o(n).onceSealed());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ne=Object(m.a)((function(e){return{root:{display:"flex",justifyContent:"space-between",padding:e.spacing(1)},button:{},about:{color:"black"}}}));var ae=function(e){var t=e.setError,n=ne(),r=_(),i=r.user,c=r.balance,o=r.updateBalance,s=Object(l.useState)(null),u=Object(O.a)(s,2),b=u[0],d=u[1],f=function(){d(null)};return Object(L.jsxs)("div",{className:n.root,children:[Object(L.jsx)(w.a,{variant:"h5",children:Object(L.jsx)("a",{href:"https://github.com/docmarionum1/bitku#readme",target:"_blank",className:n.about,children:"About"})}),i.loggedIn?Object(L.jsxs)(p.a.Fragment,{children:[Object(L.jsx)("div",{children:Object(L.jsx)(z.a,{variant:"outlined",onClick:function(e){d(e.currentTarget)},children:i.addr})}),Object(L.jsxs)(J.a,{anchorEl:b,keepMounted:!0,open:!!b,onClose:f,children:[null===c?Object(L.jsx)(Y.a,{onClick:Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(),e.next=3,ee(t);case 3:o();case 4:case"end":return e.stop()}}),e)}))),children:"Enable FUSD on this wallet"}):Object(L.jsxs)(Y.a,{disabled:!0,children:[c," FUSD"]}),Object(L.jsx)(Y.a,{onClick:function(){f(),a.p()},children:"Log Out"})]})]}):Object(L.jsx)("div",{children:Object(L.jsx)(z.a,{variant:"outlined",onClick:a.i,children:"Connect Wallet"})})]})},re=n(92),ie=n(116),ce=n(336),oe=n(176),se=Object(m.a)((function(e){return{root:{height:"20rem",display:"flex",flexDirection:"column",justifyContent:"space-evenly"},popper:{top:"10px !important",zIndex:100},tooltip:{fontSize:"1rem",maxWidth:"none"},link:{color:"inherit"}}}));var ue=function(e){var t=e.setError,n=se(),a=Object(l.useState)(null),r=Object(O.a)(a,2),c=r[0],o=r[1],s=Object(l.useState)(!0),u=Object(O.a)(s,2),b=u[0],d=u[1],f=Object(l.useState)(null),j=Object(O.a)(f,2),g=j[0],k=j[1],m=_(),v=m.user,F=m.balance,S=m.updateBalance,y=m.setUserHaikus,N=Object(l.useState)(null),T=Object(O.a)(N,2),E=T[0],C=T[1];Object(l.useEffect)((function(){function e(){return(e=Object(x.a)(h.a.mark((function e(){var t,n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api-instant.ramp.network/api/host-api/assets");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,a=n.assets.filter((function(e){return"FLOW_FUSD"==e.symbol}))[0],C(a.priceEur*a.minPurchaseAmountEur);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(l.useEffect)((function(){function e(){return(e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.t0=o,e.next=4,U();case 4:e.t1=e.sent,(0,e.t0)(e.t1),d(!1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null===c&&function(){e.apply(this,arguments)}()}),[c]),Object(l.useEffect)((function(){v.loggedIn||k(null)}),[v]);var H=Object(l.useCallback)(Object(x.a)(h.a.mark((function e(){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,X(c,t);case 4:return window.scrollTo(0,0),e.next=7,R({key:c.id,value:v.addr});case 7:n=e.sent,a=n[Object.keys(n)[0]],k({id:c.id,text:a}),y((function(e){return Object(ie.a)(Object(ie.a)({},e),{},Object(re.a)({},c.id,a))})),o(null),S(),t(null),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(1),"Declined: Externally Halted"!==e.t0.message&&"Declined: User rejected signature"!==e.t0.message&&t({text:e.t0.message,severity:"error"}),o(null);case 20:case"end":return e.stop()}}),e,null,[[1,16]])}))),[v,c]);if(b)return Object(L.jsxs)("div",{className:"spinner",id:"spinner",children:[Object(L.jsx)("div",{className:"double-bounce1"}),Object(L.jsx)("div",{className:"double-bounce2"})]});var A=!v.loggedIn||null===c||null===F||F<c.price,I="Mint Bitku #".concat(c.id," for ").concat(c.price," FUSD");return v.loggedIn?null===F?I="To mint a Bitku, please enable FUSD for your wallet using the menu in the top right":F<c.price?I=Object(L.jsxs)("span",{children:["You don't have enough FUSD.\xa0",E&&Object(L.jsxs)(p.a.Fragment,{children:[Object(L.jsxs)("a",{href:"#",className:n.link,onClick:function(){new oe.a({hostAppName:"Bitku",hostLogoUrl:i,swapAmount:Math.ceil(Math.max(c.price-F,E)*Math.pow(10,8)),swapAsset:"FLOW_FUSD",userAddress:v.addr,fiatCurrency:"EUR"}).show()},children:["Buy ",Math.max(c.price-F,E).toFixed(2)," FUSD"]}),"."]})]}):null===c&&(I="No Bitkus remaining"):I="To mint a Bitku, please connect your wallet using the menu in the top right",Object(L.jsxs)("div",{className:n.root,children:[g&&Object(L.jsxs)("div",{children:[Object(L.jsx)(w.a,{variant:"h6",children:g.id}),Object(L.jsx)(w.a,{variant:"body2",children:Object(L.jsx)(D.a,{typing:1,fixed:!0,children:g.text})})]}),Object(L.jsx)("div",{children:Object(L.jsx)(ce.a,{interactive:!0,classes:{popper:n.popper,tooltip:n.tooltip},title:I,open:A,placement:"bottom",arrow:!0,children:Object(L.jsx)("span",{children:Object(L.jsxs)(z.a,{variant:"outlined",disabled:A,onClick:H,children:["Mint Bitku #",c.id,"/1024 (",c.price," FUSD)"]})})})})]})},le=n(327),pe=n(328),be=n(329),de=Object(m.a)((function(e){return{root:{marginBottom:e.spacing(4)},paper:{padding:e.spacing(2),borderRadius:e.spacing(.5),height:"12em",display:"flex",flexDirection:"column"},skeletonContainer:{display:"flex",flexDirection:"column",flexGrow:1,justifyContent:"center"},skeleton:{margin:"auto"}}}));var fe=function(e){var t=e.haikus,n=e.heading,a=e.order,r=de(),i=a||Object.keys(t);return Object(L.jsxs)("div",{className:r.root,children:[Object(L.jsx)(w.a,{variant:"h4",children:n}),Object(L.jsx)(pe.a,{container:!0,spacing:3,children:t&&i.map((function(e){return Object(L.jsx)(pe.a,{item:!0,xs:12,sm:6,md:6,lg:4,children:Object(L.jsxs)(le.a,{elevation:3,className:r.paper,children:[Object(L.jsx)(w.a,{variant:"h6",children:e}),t[e]?Object(L.jsx)(w.a,{variant:"body2",children:t[e]}):Object(L.jsx)("div",{className:r.skeletonContainer,children:Object(L.jsxs)("div",{children:[Object(L.jsx)(be.a,{variant:"text",animation:"wave",width:"40%",className:r.skeleton}),Object(L.jsx)(be.a,{variant:"text",animation:"wave",width:"56%",className:r.skeleton}),Object(L.jsx)(be.a,{variant:"text",animation:"wave",width:"40%",className:r.skeleton})]})})]})},e)}))})]})},he=Object(k.a)({typography:{fontFamily:['"Courier New"',"courier","monospace"].join(","),h6:{textAlign:"center",textDecoration:"underline",fontSize:"1rem",fontWeight:"bold"},h4:{marginBottom:"1rem",textDecoration:"underline"},body2:{textAlign:"center",whiteSpace:"pre",flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"center"}},shape:{borderRadius:32}}),je=Object(m.a)((function(e){return{root:{textAlign:"center"},alert:{flexDirection:"row"}}}));var xe=function(){var e=je(),t=Object(l.useState)(null),n=Object(O.a)(t,2),a=n[0],i=n[1],c=Object(l.useState)(!1),o=Object(O.a)(c,2),s=o[0],u=o[1],b=Object(l.useState)(!1),d=Object(O.a)(b,2),f=d[0],k=d[1],m=W().userHaikus,N=r,T=[40,29,0,4,5,28,41,62],E=Object(l.useState)({}),C=Object(O.a)(E,2),U=C[0],H=C[1],A=function(){return u(!1)};return Object(l.useEffect)((function(){null!==a&&u(!0)}),[a]),Object(l.useEffect)((function(){function e(){return(e=Object(x.a)(h.a.mark((function e(){var t,n,a,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=Object(j.a)(T);try{for(n.s();!(a=n.n()).done;)r=a.value,t.push({key:r,value:N})}catch(i){n.e(i)}finally{n.f()}return e.t0=H,e.next=6,R(t);case 6:e.t1=e.sent,(0,e.t0)(e.t1);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(L.jsxs)(p.a.Fragment,{children:[Object(L.jsx)(g.a,{}),Object(L.jsx)(v.a,{theme:he,children:Object(L.jsxs)("div",{className:e.root,children:[Object(L.jsx)(ae,{setError:i}),Object(L.jsxs)(y.a,{children:[Object(L.jsx)(w.a,{variant:"h1",children:Object(L.jsx)(D.a,{typing:1,onTypingEnd:function(){return k(!0)},children:"Bitku"})}),f&&Object(L.jsxs)(p.a.Fragment,{children:[Object(L.jsx)(ue,{setError:i}),Object(L.jsx)(fe,{haikus:U,order:T,heading:"Featured"}),Object(L.jsx)(fe,{haikus:m,heading:"My Bitku"})]}),a&&Object(L.jsx)(F.a,{open:s,autoHideDuration:1e4,onClose:A,children:Object(L.jsx)(S.a,{onClose:A,severity:a.severity,className:e.alert,children:a.text})})]})]})})]})},Oe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,339)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),i(e),c(e)}))};d.a.render(Object(L.jsx)(p.a.StrictMode,{children:Object(L.jsx)(M,{children:Object(L.jsx)(xe,{})})}),document.getElementById("root")),Oe()}},[[287,1,2]]]);
//# sourceMappingURL=main.72a73cf5.chunk.js.map